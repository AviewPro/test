<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Schrödinger Baseball - Single Mode</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Bebas+Neue&display=swap" rel="stylesheet">
    <style>
        :root { 
            --bg: #050507; --cyan: #00f2ff; --purple: #bc13fe; --green: #00ff41; --red: #ff4b2b; 
            --unit: 1vh; 
        }
        
        html { height: 100%; }

        body { 
            background: linear-gradient(rgba(5, 5, 7, 0.8), rgba(5, 5, 7, 0.8)), url('cat footage.gif');
            background-size: cover; background-position: center; background-attachment: fixed;
            color: #fff; font-family: 'Segoe UI', sans-serif; display: flex; flex-direction: column; 
            align-items: center; justify-content: flex-start; min-height: 100vh; margin: 0; padding: 0;
            user-select: none; -webkit-user-select: none;
        }

        #version-tag { position: fixed; bottom: 1.5vh; left: 2vh; color: #555; font-family: 'Orbitron', sans-serif; font-size: 2.4vh; letter-spacing: 0.1vh; z-index: 500; }
        
        #sound-control { position: fixed; right: 2vh; top: 50%; transform: translateY(-50%); display: flex; flex-direction: column; align-items: center; gap: 1vh; background: rgba(0,0,0,0.7); padding: 1.5vh 1vh; border-radius: 3vh; border: 0.1vh solid var(--cyan); z-index: 10000; }
        #sound-control input[type=range] { -webkit-appearance: slider-vertical; width: 0.8vh; height: 15vh; cursor: pointer; }
        .sound-icon { font-size: 1.5vh; color: var(--cyan); }

        .title-wrapper { position: relative; margin-top: 5vh; margin-bottom: 3vh; z-index: 300; display: flex; flex-direction: column; justify-content: center; align-items: center; flex-shrink: 0; }
        .title-bg { position: absolute; background: rgba(0, 0, 0, 0.7); width: 120%; height: 120%; border-radius: 1.5vh; filter: blur(0.5vh); z-index: -1; }
        .header-title { font-size: 5vh; font-weight: bold; letter-spacing: 1.2vh; text-shadow: 0 0 2vh currentColor; animation: neonShift 10s infinite alternate linear; text-align: center; margin: 0; padding: 1vh 4vh 0.5vh 4vh; }
        .header-subtitle { font-family: 'Orbitron', sans-serif; font-size: 1.8vh; color: var(--cyan); letter-spacing: 0.5vh; opacity: 0.8; margin-top: 0.5vh; margin-bottom: 1.5vh; padding-top: 1.5vh; }
        
        @keyframes neonShift { 0% { color: var(--cyan); border-color: var(--cyan); box-shadow: 0 0 2vh var(--cyan); } 100% { color: var(--purple); border-color: var(--purple); box-shadow: 0 0 2vh var(--purple); } }
        @keyframes neonShiftBg { 0% { background-color: var(--cyan); box-shadow: 0 0 1.5vh var(--cyan); } 100% { background-color: var(--purple); box-shadow: 0 0 1.5vh var(--purple); } }
        @keyframes keyholeNeonShift { 0% { filter: drop-shadow(0 0 1.5vh var(--cyan)) drop-shadow(0 0 3vh var(--cyan)); } 100% { filter: drop-shadow(0 0 1.5vh var(--purple)) drop-shadow(0 0 3vh var(--purple)); } }

        .game-container { display: flex; flex-direction: column; align-items: center; justify-content: center; width: 95%; height: auto; padding-bottom: 5vh; }
        
        #setup { width: 50vh; height: auto; padding: 4vh; border-radius: 2.5vh; background: rgba(10, 10, 15, 0.95); border: 0.4vh solid var(--green); z-index: 200; text-align: center; box-sizing: border-box; box-shadow: 0 0 3vh rgba(0, 242, 255, 0.3); display: flex; flex-direction: column; align-items: center; justify-content: center; margin-bottom: 1vh; }
        .setup-box-container { position: relative; width: 35vh; margin-bottom: 2vh; }
        .setup-cat { width: 35vh; height: 35vh; border-radius: 4vh; border: 0.4vh solid var(--green); object-fit: cover; animation: neonShift 10s infinite alternate linear; display: block; }
        
        .setup-btn { font-family: 'Bebas Neue', cursive; width: 35vh; color: #000; font-weight: 900; height: 7vh; font-size: 3.2vh; border-radius: 1.5vh; cursor: pointer; border: none; animation: neonShiftBg 10s infinite alternate linear; margin-top: 1vh; transition: transform 0.1s, filter 0.2s; letter-spacing: 0.1vh; }
        .tutorial-btn { font-family: 'Bebas Neue', cursive; width: 35vh; background: #444; color: #fff; font-weight: 700; height: 5vh; font-size: 2.5vh; border-radius: 1.5vh; cursor: pointer; border: 0.2vh solid #666; margin-bottom: 1vh; transition: 0.2s; letter-spacing: 0.1vh; }

        .new-keyhole { width: 35vh; height: auto; margin-top: 1.5vh; animation: keyholeNeonShift 10s infinite alternate linear; }

        #game-box, #info-panel { width: 50vh; height: 75vh; padding: 2.5vh; border-radius: 2.5vh; box-sizing: border-box; display: flex; flex-direction: column; flex-shrink: 0; margin-bottom: 3vh; }
        #game-box { background: rgba(17, 17, 17, 0.9); border: 0.1vh solid #333; position: relative; display: none; }
        #info-panel { background: rgba(10, 10, 15, 0.9); border: 0.1vh solid #333; display: none; position: relative; }
        
        .status { text-align:center; margin-bottom:1.5vh; font-weight:bold; height:3vh; font-size: 2.2vh; animation: neonShift 10s infinite alternate linear; transform: translateY(-1vh); }
        #log-window { height: 26vh; background: #000; overflow-y: auto; padding: 1vh; font-family: 'Consolas', monospace; margin-bottom: 1.5vh; border: 0.1vh inset #222; display: grid; grid-template-columns: 1fr 1fr; grid-auto-rows: 8.5vh; gap: 0px; align-content: start; position: relative; }
        .log-item { padding: 0.5vh; display: flex; flex-direction: column; justify-content: center; background: rgba(0, 242, 255, 0.05); color: var(--cyan); border-bottom: 0.1vh solid #222; position: relative; box-sizing: border-box; text-align: center; }
        .log-n { font-family: 'Orbitron', sans-serif; font-size: 3vh; font-weight: 900; display: block; letter-spacing: 0.2vh; color: #fff; }
        .log-sb { font-weight: bold; font-size: 1.8vh; color: var(--purple); margin-top: 0.2vh; }
        .log-out { color: #bc13fe; text-shadow: 0 0 1vh #bc13fe; }
        
        .training-clear-msg { grid-column: span 2; display: flex; flex-direction: column; align-items: center; justify-content: center; position: absolute; top: 0; left: 0; width: 100%; height: 100%; color: var(--green); font-size: 2.2vh; font-weight: bold; text-align: center; text-shadow: 0 0 1vh var(--green); line-height: 1.6; z-index: 10; pointer-events: none; }
        .count-highlight { font-size: 4vh; margin-bottom: 0.5vh; display: block; }

        .chance-area { display: flex; align-items: center; justify-content: space-between; margin-bottom: 2.5vh; gap: 2vh; height: 16vh; position: relative; }
        #chance-box { background: rgba(0,0,0,0.6); padding: 1vh; border-radius: 2vh; border: 0.2vh solid var(--purple); text-align: center; flex: 1; height: 100%; display: flex; flex-direction: column; justify-content: center; box-sizing: border-box; transition: border-color 0.5s; z-index: 5; }
        .chance-title { font-family: 'Bebas Neue', cursive; font-size: 2.4vh; font-weight: bold; display: block; margin-bottom: 0.5vh; transition: color 0.5s, text-shadow 0.5s; }
        .chance-value { font-size: 5.85vh; font-weight: 900; color: var(--purple); text-shadow: 0 0 2.5vh var(--purple); font-family: 'Orbitron', sans-serif; line-height: 1.1; }
        
        .poison-text { font-size: 2.8vh; letter-spacing: -0.1vh; line-height: 1.1; font-weight: 900; display: inline-block; animation: floatingText 3s infinite ease-in-out; } 
        @keyframes floatingText { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-0.8vh); } }

        .prob-cat-container { position: relative; width: 16vh; height: 16vh; flex-shrink: 0; display: flex; align-items: center; justify-content: center; }
        .prob-cat { width: 100%; height: 100%; border-radius: 2.5vh; border: 0.2vh solid var(--purple); object-fit: cover; box-sizing: border-box; z-index: 1; }
        #turn-counter { position: absolute; font-weight: 900; font-size: 8vh; z-index: 20; pointer-events: none; transition: transform 2s ease-in-out, color 0.5s; will-change: transform; }

        #candidates-box { flex-grow: 1; overflow: hidden; display: flex; flex-direction: column; position: relative; }
        .cand-title { font-family: 'Bebas Neue', cursive; font-size: 3vh; color:#fff; margin-bottom: 1.5vh; font-weight:bold; text-align: center; padding: 1vh 0; border-top: 0.1vh solid #333; border-bottom: 0.1vh solid #333; }
        #cand-list { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1vh; overflow-y: hidden; overflow-x: hidden; font-family: 'Consolas', monospace; font-size: 1.8vh; color: #fff; flex-grow: 1; align-content: start; }
        .cand-item { padding: 0.4vh 0.2vh; height: 3vh; line-height: 3vh; text-align: center; background: rgba(255,255,255,0.07); border-radius: 0.6vh; transition: none; will-change: transform; }

        #paradox-cat-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 100; display: none; opacity: 0; border-radius: 1vh; }

        .input-view { 
            background: #000; font-family: 'Orbitron', sans-serif; font-size: 4.5vh; text-align: center; height: 9vh; 
            line-height: 9vh; border-radius: 1.2vh; margin-bottom: 2vh; color: #fff; border: 0.1vh inset #222; 
            letter-spacing: 1.5vh; font-weight: 900; text-shadow: 0 0 1vh var(--cyan);
        }

        .keypad { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1vh; flex-grow: 1; }
        button { background: #222; border: none; color: #fff; padding: 1vh 0; border-radius: 1vh; cursor: pointer; font-size: 2.4vh; box-shadow: 0.2vh 0.2vh 0.5vh rgba(0,0,0,0.5); transition: background 0.2s, transform 0.1s, filter 0.2s; }
        button:hover:not(:disabled) { filter: brightness(1.3); transform: translateY(-0.2vh); }
        button:active:not(:disabled), button.active { transform: translateY(0.2vh); filter: brightness(0.8); }
        button:disabled { opacity: 0.1; cursor: not-allowed; }
        
        .btn-clr { font-family: 'Bebas Neue', cursive; background: var(--cyan) !important; color: #000 !important; font-weight: bold; border: 0.2vh solid rgba(255,255,255,0.4); box-shadow: inset 0 0 1vh rgba(255,255,255,0.5), 0 0 1.5vh var(--cyan); font-size: 2.5vh !important; }
        .btn-obs { font-family: 'Bebas Neue', cursive; background: var(--purple); color: #000; font-weight: bold; border: 0.2vh solid rgba(255,255,255,0.2); box-shadow: inset 0 0 1.5vh rgba(0,0,0,0.5), 0 0 1.5vh var(--purple); font-size: 2.5vh !important; }
        .btn-ent { font-family: 'Bebas Neue', cursive; background: var(--green); color: #000; font-weight: bold; grid-row: span 2; border: 0.2vh solid rgba(0,0,0,0.2); box-shadow: inset 0 0 1.5vh rgba(255,255,255,0.3), 0 0 1.5vh var(--green); font-size: 2.5vh !important; }
        
        .overlay { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.96); flex-direction: column; align-items: center; justify-content: center; z-index: 1000; }
        #quantum-field { position: absolute; width: 100%; height: 100%; top: 0; left: 0; overflow: hidden; pointer-events: none; z-index: 1001; }
        .bg-candidate { position: absolute; font-family: 'Courier New', monospace; font-size: 6.5vh; font-weight: bold; text-shadow: 0 0 1.5vh currentColor; animation: blinkSync 4s infinite ease-in-out; opacity: 0; }
        @keyframes blinkSync { 0%, 100% { opacity: 0; transform: scale(0.9); } 50% { opacity: 0.7; transform: scale(1.1); } }

        .panel-center { position: relative; z-index: 1010; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; background: #0a0a0c; padding: 5vh; border-radius: 4vh; border: 0.2vh solid var(--purple); width: 60vh; box-shadow: 0 0 10vh rgba(0, 0, 0, 1); }

        #tutorial-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 5000; flex-direction: column; align-items: center; justify-content: center; }
        .tutorial-msg-box { background: #1a1a1a; border: 0.3vh solid #666; padding: 3vh; border-radius: 2vh; width: 60vh; text-align: center; box-shadow: 0 0 2vh rgba(0,0,0,0.8); }
        .tutorial-msg-box h3 { color: #ccc; font-size: 3vh; margin-top: 0; margin-bottom: 1.5vh; }
        .tutorial-msg-box p { font-size: 2vh; color: #ddd; line-height: 1.6; margin-bottom: 3vh; }
        .tutorial-msg-box button { background: #444; color: #fff; padding: 1vh 3vh; border: 0.1vh solid #666; border-radius: 1vh; font-weight: bold; cursor: pointer; }
        .tutorial-highlight { outline: 0.5vh solid var(--red) !important; box-shadow: 0 0 3vh var(--red) !important; opacity: 1 !important; }
        .tutorial-dim { opacity: 0.2 !important; pointer-events: none !important; }

        #flash-overlay { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none; z-index: 99999; opacity: 0; background: #000; }
        #dead-x { display: none; position: absolute; top: 62%; left: 50%; transform: translate(-50%, -50%); font-size: 30vh; color: var(--green); text-shadow: 0 0 4vh var(--green); font-weight: 900; opacity: 0.8; z-index: 150; }

        .emoji-lane { position: fixed; white-space: nowrap; font-size: 5vh; pointer-events: none; z-index: 5; opacity: 0.6; }
        @keyframes slide-h { from { transform: translateX(-150%); } to { transform: translateX(150vw); } }
    </style>
</head>
<body>

<div id="version-tag">0.5 Version</div>
<div id="flash-overlay"></div>

<div id="sound-control">
    <span class="sound-icon">♪</span>
    <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="0.15" oninput="_0x3f2a(this.value)">
    <span class="sound-icon" style="font-size:1vh;">VOL</span>
</div>

<div id="tutorial-overlay">
    <div class="tutorial-msg-box">
        <h3 id="tut-title">튜토리얼</h3>
        <p id="tut-desc">내용</p>
        <button id="tut-next-btn" onclick="_0x5a1b()">다음</button>
    </div>
</div>

<div class="title-wrapper">
    <div class="title-bg"></div>
    <div class="header-title">SCHRÖDINGER BASEBALL</div>
    <div class="header-subtitle">-Training Field-</div>
</div>

<div class="game-container">
    <div id="setup">
        <div class="setup-box-container">
            <img src="귀여운고양이도트4.jpg" class="setup-cat">
        </div>
        <button onclick="_0x1d2e()" class="tutorial-btn">How to Play</button>
        <button onclick="_0x4c5b()" class="setup-btn">Start Single Mode</button>
        <img src="Aview.png" class="new-keyhole">
    </div>

    <div style="display: flex; flex-wrap: wrap; gap: 3vh; justify-content: center; width: 100%;">
        <div id="game-box">
            <div class="status" id="status">준비 완료</div>
            <div id="log-window"></div>
            <div class="input-view" id="display">---</div>
            <div class="keypad">
                <button class="key-btn" onclick="_0x9b8a('7')">7</button><button class="key-btn" onclick="_0x9b8a('8')">8</button><button class="key-btn" onclick="_0x9b8a('9')">9</button>
                <button id="obs-btn" class="btn-obs" onclick="_0x2f1e()">OBS</button>
                <button class="key-btn" onclick="_0x9b8a('4')">4</button><button class="key-btn" onclick="_0x9b8a('5')">5</button><button class="key-btn" onclick="_0x9b8a('6')">6</button>
                <button id="clr-btn" class="btn-clr" onclick="_0x7c3d('CLR')">CLR</button>
                <button class="key-btn" onclick="_0x9b8a('1')">1</button><button class="key-btn" onclick="_0x9b8a('2')">2</button><button class="key-btn" onclick="_0x9b8a('3')">3</button>
                <button id="ent-btn" class="btn-ent" onclick="_0x7c3d('ENT')">ENT</button>
                <button id="zero-btn" style="grid-column: span 3" onclick="_0x9b8a('0')">0</button>
            </div>
        </div>

        <div id="info-panel">
            <div id="dead-x">X</div>
            <div class="chance-area">
                <div id="chance-box">
                    <span id="chance-title" class="chance-title">Measuring Energy Level</span>
                    <div id="chance-val" class="chance-value">--.--%</div>
                </div>
                <div class="prob-cat-container">
                    <div id="turn-counter">6</div>
                    <img id="prob-cat-img" src="귀여운고양이도트4.jpg" class="prob-cat">
                </div>
            </div>
            <div id="candidates-box">
                <div class="cand-title">Quantum Cloud</div>
                <div id="cand-list"></div>
                <img id="paradox-cat-overlay" src="cat footage3.jpg">
            </div>
        </div>
    </div>
</div>

<div id="obs-overlay" class="overlay">
    <div id="quantum-field"></div>
    <div id="obs-input-container" class="panel-center">
        <h2 style="font-family: 'Bebas Neue', cursive; color:var(--purple); font-size:7vh; margin:0;">Observation</h2>
        <p style="color:var(--purple); font-size:2vh;"><b>양자고양이의 좌표를 관측하세요!</b></p>
        <input type="tel" id="obs-num" maxlength="3" style="background:#000; color:#fff; font-family: 'Orbitron', sans-serif; font-size: 5vh; text-align:center; width:35vh; margin:4vh 0; border:0.3vh solid var(--purple); border-radius:1.5vh; letter-spacing:1.5vh;">
        <button onclick="_0x6f5a()" style="padding:1.5vh 8vh; background:var(--purple); color:#fff; font-weight:bold; font-size:4vh; border-radius:1.5vh;">관측 실행</button>
    </div>
</div>

<script>
    // JSON 데이터 하드코딩 통합
    const _0xtextData = {
        "endings": {
            "paradox": { "type": "Training Complete", "result": "양자고양이 추적자", "message": "축하합니다! 당신은 양자고양이 추적시험을 통과했습니다.<br> 슈뢰딩거의 고양이를 찾기위해 더 어려운 난이도에 도전하시겠습니까? <br>당신의 고양이에 대한 사랑을 증명해보세요!" },
            "win": { "type": "Quantum Collapse", "result": "승리", "message": "관측 성공! 당신의 고양이는 살아있었습니다<br>당신은 고양이의 위치만을 알 수 있었습니다" },
            "lose": { "type": "Quantum Collapse", "result": "패배", "message": "관측 실패! 당신의 고양이는 사라졌습니다<br>당신은 고양이의 운동량만을 알 수 있었습니다" }
        },
        "tips": {
            "fail": [
                { "title": "실패 시 참고팁 (1/3)", "desc": "이 게임의 처음, 두번째에 가장 무난한 선택지는 123, 456이 아닐지도 모릅니다.<br>조금 다른방식으로 접근을 해보는건 어떨까요?" },
                { "title": "실패 시 참고팁 (2/3)", "desc": "그리고 고양이의 알고리즘 첫번째는 계속 1Ball 판정이 고정입니다.<br>처음 판정받은 숫자들을 돌려가며 다른식으로 배치해보세요<br>그렇게 하면 3~4턴 사이에는 금새 가능성이 좁혀지게 됩니다." },
                { "title": "실패 시 참고팁 (3/3)", "desc": "어느정도 좌표가 특정된 후 양자구름에 표시된 숫자를 보고 측정을 하면<br>양자고양이를 관측할 수 있을겁니다. 화이팅!" }
            ],
            "success": [
                { "title": "성공 시 참고팁 (1/5)", "desc": "눈치를 못채셨을 수도 있지만 이 게임은 관측에 성공을 하든 실패를 하든<br><span style='color:var(--cyan); font-weight:bold;'>Quantum Collapse(양자 붕괴)</span>엔딩이 나옵니다. <br>그렇게 한 것은 관측 성공도 이 게임의 진짜 목표가 아니기 때문입니다." },
                { "title": "성공 시 참고팁 (2/5)", "desc": "단순히 관측 성공을 하는거 자체는 너무 난이도가 낮으니까요. <br><span style='color:var(--cyan); font-weight:bold;'>이 게임은 정확히 5턴의 좌표확인으로 100%로 양자고양이의 좌표를 특정하고 <br>6턴째 좌표입력까지 진행해서 모순을 찾고 양자고양이를 잡는 게임입니다.</span>" },
                { "title": "성공 시 참고팁 (3/5)", "desc": "양자고양이는 계속해서 최대한 안전해보이는 좌표로 도망칩니다. <br>정확히는 가능한 후보 숫자가 가장 많은 볼카운트 대답한다는 의미죠." },
                { "title": "성공 시 참고팁 (4/5)", "desc": "고정된 알고리즘이기 때문에 똑같은 질문을 100번 하면 100번 똑같이 답합니다.<br> 일정한 빌드를 만들어서 가장 높은 확률을 따라가면 최적화되는 구조입니다. <br>측정 숫자를 교차로 배치해서 몰이사냥을 하듯이 숨을 곳을 좁히세요." },
                { "title": "성공 시 참고팁 (5/5)", "desc": "당신은 고양이 추적자 역량을 기르기 위해 <span style='color:var(--green); font-weight:bold;'>진심으로 도전</span>을 해보겠다는 건가요?<br> 그런분은 정말 환영입니다. " }
            ]
        },
        "tutorial": {
            "steps": [
                { "step": 1, "title": "1. 숫자 입력", "desc": "입력 패널의 버튼을 눌러서 입력하거나 키보드 숫자키를 활용해<br>임의의 3자리 수를 입력해보세요." },
                { "step": 2, "title": "2. 양자고양이 좌표 측정", "desc": "입력 패널의 엔터키나 키보드 Enter를 통해서 양자 고양이의 좌표를 측정하세요.<br>고양이가 숨어있는 3자리 좌표를 찾으면 됩니다." },
                { "step": 3, "title": "3. 결과 표시 판넬", "desc": "S는 숫자와 위치가 모두 맞는 숫자의 개수이며<br>B는 숫자는 맞지만 위치는 틀린 숫자의 개수입니다." },
                { "step": 4, "title": "4. 양자 구름의 의미", "desc": "좌표 측정을 진행하다 보면 양자고양이가 위치할 가능성이 있는 좌표들이<br>점차 선명히 보이기 시작합니다." },
                { "step": 5, "title": "5. 관측 확률", "desc": "지금까지 판정결과에 부합하는 임의의 숫자로 관측했을 때 찾을 확률입니다.<br>관측은 입력패널의 우상단 보라색 버튼을 통해 진행합니다." },
                { "step": 6, "title": "6. 횟수 제한 및 엔딩", "desc": "양자고양이는 언제나 가장 잘 숨을 수 있는 좌표로 도망칩니다.<br><span style='color:var(--red); font-weight:bold;'>6턴의 좌표 측정만으로 고양이의 좌표를 찾아보세요!</span>" }
            ],
            "button_finish": "게임하러 가기"
        }
    };

    let _0xaiCandidates = [], _0xhistory = [], _0xinputStr = "", _0xturnCount = 6;
    let _0xisTutorial = false, _0xtutorialStep = 1, _0xcurrentTipType = "", _0xtipIndex = 0;
    let _0xcurrentVolume = 0.15;
    let _0xbgm = new Audio("002. ErikMMusic - The Dusty Attic.mp3");
    _0xbgm.loop = true; _0xbgm.playbackRate = 2.0;

    function _0x3f2a(val) { _0xcurrentVolume = parseFloat(val); _0xbgm.volume = _0xcurrentVolume; }

    function _0x4c5b() {
        document.getElementById('setup').style.display = 'none';
        document.getElementById('game-box').style.display = 'flex';
        document.getElementById('info-panel').style.display = 'flex';
        _0xresGm();
    }

    function _0xresGm() {
        _0xaiCandidates = []; _0xhistory = []; _0xinputStr = ""; _0xturnCount = 6;
        for(let i=0; i<=999; i++){
            let n = i.toString().padStart(3, '0');
            if(new Set(n).size === 3) _0xaiCandidates.push(n);
        }
        _0xupUI();
    }

    // 튜토리얼 로직
    function _0x1d2e() {
        _0xisTutorial = true; _0xtutorialStep = 1;
        _0x4c5b();
        document.getElementById('tutorial-overlay').style.display = 'flex';
        _0xappTut();
    }

    function _0x5a1b() {
        if(_0xcurrentTipType !== "") {
            _0xtipIndex++;
            if(_0xtipIndex >= _0xtextData.tips[_0xcurrentTipType].length) {
                document.getElementById('tutorial-overlay').style.display = 'none';
                return;
            }
            _0xshowNextTip();
        } else {
            _0xtutorialStep++;
            if(_0xtutorialStep > 6) { location.reload(); return; }
            _0xappTut();
        }
    }

    function _0xappTut() {
        const step = _0xtextData.tutorial.steps.find(s => s.step === _0xtutorialStep);
        document.getElementById('tut-title').innerText = step.title;
        document.getElementById('tut-desc').innerHTML = step.desc;
        const btn = document.getElementById('tut-next-btn');
        if(_0xtutorialStep === 6) btn.innerText = _0xtextData.tutorial.button_finish;
        
        // 하이라이트 연출 (생략 가능하나 가독성을 위해 유지)
        document.querySelectorAll('.tutorial-highlight').forEach(el => el.classList.remove('tutorial-highlight'));
        if(_0xtutorialStep === 1) document.querySelector('.keypad').classList.add('tutorial-highlight');
        if(_0xtutorialStep === 3) document.getElementById('log-window').classList.add('tutorial-highlight');
        if(_0xtutorialStep === 4) document.getElementById('candidates-box').classList.add('tutorial-highlight');
        if(_0xtutorialStep === 5) document.getElementById('obs-btn').classList.add('tutorial-highlight');
    }

    // 팁 보여주기 로직
    window.showTips = function(type) {
        _0xcurrentTipType = type;
        _0xtipIndex = 0;
        document.getElementById('tutorial-overlay').style.display = 'flex';
        _0xshowNextTip();
    };

    function _0xshowNextTip() {
        const tip = _0xtextData.tips[_0xcurrentTipType][_0xtipIndex];
        document.getElementById('tut-title').innerText = tip.title;
        document.getElementById('tut-desc').innerHTML = tip.desc;
        document.getElementById('tut-next-btn').innerText = "다음";
    }

    function _0x9b8a(n) { 
        if(_0xinputStr.length < 3 && !_0xinputStr.includes(n)) { 
            _0xinputStr += n; document.getElementById('display').innerText = _0xinputStr; 
        } 
    }

    function _0x7c3d(type) {
        if(type === 'CLR') { _0xinputStr = ""; document.getElementById('display').innerText = "---"; }
        if(type === 'ENT' && _0xinputStr.length === 3 && _0xturnCount > 0) {
            const res = _0xaiRes(_0xinputStr);
            _0xhistory.push({ n: _0xinputStr, s: res.s, b: res.b });
            _0xturnCount--; _0xinputStr = ""; document.getElementById('display').innerText = "---";
            _0xupUI();
        }
    }

    function _0xaiRes(guess) {
        const outcomes = {};
        _0xaiCandidates.forEach(cand => {
            let s=0, b=0;
            for(let i=0; i<3; i++){ if(guess[i] === cand[i]) s++; else if(cand.includes(guess[i])) b++; }
            const key = `${s}S${b}B`;
            if(!outcomes[key]) outcomes[key] = []; outcomes[key].push(cand);
        });
        let bestKey = ""; let maxCount = -1;
        for(let key in outcomes) {
            if(key === "3S0B") continue; 
            if(outcomes[key].length > maxCount) { maxCount = outcomes[key].length; bestKey = key; }
        }
        if(!bestKey || _0xaiCandidates.length <= 1) { _0xaiCandidates = _0xaiCandidates.filter(c => c !== guess); return {s:0, b:1}; }
        _0xaiCandidates = outcomes[bestKey];
        const m = bestKey.match(/(\d)S(\d)B/);
        return { s: parseInt(m[1]), b: parseInt(m[2]) };
    }

    function _0xupUI() {
        document.getElementById('turn-counter').innerText = _0xturnCount;
        const prob = _0xaiCandidates.length === 0 ? 0 : (1 / _0xaiCandidates.length * 100);
        document.getElementById('chance-val').innerText = prob.toFixed(2) + "%";
        
        const logWindow = document.getElementById('log-window');
        if(_0xaiCandidates.length === 0) {
            logWindow.innerHTML = `<div class="training-clear-msg">훈련 통과!</div>`;
            document.getElementById('dead-x').style.display = 'block';
        } else {
            logWindow.innerHTML = _0xhistory.map(h => `<div class="log-item"><span class="log-n">${h.n}</span><span class="log-sb">${h.s}S / ${h.b}B</span></div>`).join('');
        }
        
        const slice = [..._0xaiCandidates].sort(() => 0.5 - Math.random()).slice(0, 60);
        document.getElementById('cand-list').innerHTML = slice.map(c => `<div class="cand-item">${c}</div>`).join('');
        
        const statusEl = document.getElementById('status');
        if(_0xturnCount <= 0) statusEl.innerText = "측정 완료 (관측만 가능)";
        else statusEl.innerText = "고양이 위치 관측 중...";
    }

    function _0x2f1e() {
        if(_0xaiCandidates.length === 0) {
            const ed = _0xtextData.endings.paradox;
            _0xrnEG(ed.type, ed.result, ed.message, 'var(--green)', true, true);
            return;
        }
        document.getElementById('obs-overlay').style.display = 'flex';
    }

    function _0x6f5a() {
        const guess = document.getElementById('obs-num').value;
        if(guess.length === 3) {
            let secret = _0xaiCandidates[Math.floor(Math.random() * _0xaiCandidates.length)];
            if(guess === secret) {
                const ed = _0xtextData.endings.win;
                _0xrnEG(ed.type, ed.result, ed.message, 'var(--cyan)', true, false);
            } else {
                const ed = _0xtextData.endings.lose;
                _0xrnEG(ed.type, ed.result, ed.message, 'var(--red)', false, false);
            }
        }
    }

    function _0xrnEG(type, result, msg, color, isWin, isParadox) {
        const media = isParadox ? "Neon cat box.gif" : (isWin ? "cat in the box.gif" : "box.gif");
        const tipType = isWin ? "success" : "fail";
        
        document.body.innerHTML = `
            <div id="version-tag">0.5 Version</div>
            <div style="display:flex; flex-direction:column; align-items:center; justify-content:center; min-height:100vh; text-align:center; padding:5vh;">
                <img src="${media}" style="border:0.4vh solid ${color}; border-radius:4vh; width:40vh; height:40vh; object-fit:cover; margin-bottom:2vh; box-shadow:0 0 3vh ${color};">
                <h1 style="font-size:6vh; color:${color}; text-shadow:0 0 2vh ${color}; margin:1vh 0;">${type}</h1>
                <h2 style="font-size:4vh; color:#fff; margin-bottom:1vh;">${result}</h2>
                <p style="color:#ccc; font-size:2.5vh; line-height:1.6; margin-bottom:4vh;">${msg}</p>
                <div style="display:flex; flex-direction:column; gap:2vh; width:50vh;">
                    ${!isParadox ? `<button onclick="window.showTips('${tipType}')" style="background:#333; color:${color}; border:0.2vh solid ${color}; padding:1.5vh; font-size:3vh; font-weight:bold; cursor:pointer;">TIPS</button>` : ''}
                    <button onclick="location.reload()" style="background:#222; color:#fff; border:0.2vh solid #444; padding:1.5vh; font-size:3vh; cursor:pointer;">Restart</button>
                </div>
            </div>`;
    }

    setInterval(() => {
        const turnCounter = document.getElementById('turn-counter');
        if(turnCounter && _0xturnCount > 0) {
            const intensity = 15; 
            turnCounter.style.transform = `translate(${(Math.random()-0.5)*intensity}px, ${(Math.random()-0.5)*intensity}px)`;
        }
    }, 100);
</script>
</body>
</html>